annotations:
  list:
    - builtIn: 1
      datasource:
        type: grafana
        uid: "-- Grafana --"
      enable: true
      hide: true
      iconColor: "rgba(0, 211, 255, 1)"
      name: Annotations & Alerts
      type: dashboard
editable: false
fiscalYearStartMonth: 0
graphTooltip: 0
links: []
panels:
  - collapsed: false
    gridPos:
      h: 1
      w: 24
      x: 0
      y: 0
    panels: []
    title: Service stats ($service)
    type: row
  - datasource:
      type: datasource
      uid: "-- Dashboard --"
    fieldConfig:
      defaults:
        color:
          fixedColor: purple
          mode: fixed
        mappings:
          - options:
              match: "null"
              result:
                text: N/A
            type: special
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
        unit: short
      overrides: []
    gridPos:
      h: 2
      w: 8
      x: 0
      y: 1
    interval: $agg_interval
    options:
      colorMode: value
      graphMode: area
      justifyMode: auto
      orientation: auto
      percentChangeColorMode: standard
      reduceOptions:
        calcs:
          - lastNotNull
        fields: ""
        values: false
      showPercentChange: false
      text: {}
      textMode: auto
      wideLayout: true
    targets:
      - datasource:
          type: datasource
          uid: "-- Dashboard --"
        panelId: 1
        refId: A
    title: Load
    transformations:
      - id: filterFieldsByName
        options:
          include:
            pattern: Total
      - id: reduce
        options:
          includeTimeField: false
          mode: seriesToRows
          reducers:
            - mean
            - sum
      - id: organize
        options:
          excludeByName: {}
          indexByName: {}
          renameByName:
            Mean: Average load
            Total: Total
    type: stat
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    fieldConfig:
      defaults:
        color:
          fixedColor: rgb(31, 120, 193)
          mode: fixed
        mappings:
          - options:
              match: "null"
              result:
                text: N/A
            type: special
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: s
      overrides: []
    gridPos:
      h: 2
      w: 8
      x: 8
      y: 1
    options:
      colorMode: value
      graphMode: none
      justifyMode: auto
      orientation: horizontal
      percentChangeColorMode: standard
      reduceOptions:
        calcs:
          - mean
        fields: ""
        values: false
      showPercentChange: false
      text: {}
      textMode: auto
      wideLayout: true
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum(traefik_service_request_duration_seconds_sum{service_namespace=~"$namespace", service=~"$service", protocol=~"http|grpc|grpc-web"})
          /
          sum(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service", protocol=~"http|grpc|grpc-web"})
        format: time_series
        interval: ""
        intervalFactor: 2
        legendFormat: Average response time
        range: true
        refId: A
    title: Average response time
    type: stat
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    fieldConfig:
      defaults:
        color:
          fixedColor: red
          mode: fixed
        mappings:
          - options:
              match: "null"
              result:
                text: N/A
            type: special
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: percent
      overrides:
        - matcher:
            id: byName
            options: Total
          properties:
            - id: unit
              value: short
            - id: decimals
              value: 0
    gridPos:
      h: 2
      w: 8
      x: 16
      y: 1
    interval: $agg_interval
    options:
      colorMode: value
      graphMode: none
      justifyMode: auto
      orientation: auto
      percentChangeColorMode: standard
      reduceOptions:
        calcs:
          - sum
        fields: ""
        values: false
      showPercentChange: false
      text: {}
      textMode: auto
      wideLayout: true
    targets:
      - datasource:
          type: prometheus
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        exemplar: false
        expr: >-
          sum(increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service", protocol="http", code=~"^[45]\\d{2}"}[$__interval] offset
          -$__interval))
        format: time_series
        instant: false
        legendFormat: Errors
        range: true
        refId: A
      - datasource:
          type: prometheus
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        exemplar: false
        expr: >-
          sum(increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service"}[$__interval] offset -$__interval))
        format: time_series
        instant: false
        legendFormat: Total
        range: true
        refId: B
    title: Errors
    transformations:
      - id: calculateField
        options:
          alias: Rate
          binary:
            left: Errors
            operator: /
            reducer: sum
            right: Total
          mode: binary
          reduce:
            include: []
            reducer: sum
      - id: organize
        options:
          excludeByName:
            Total: true
          indexByName: {}
          renameByName:
            Errors: Total
    type: stat
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          axisBorderShow: false
          axisCenteredZero: false
          axisColorMode: text
          axisLabel: ""
          axisPlacement: auto
          barAlignment: -1
          barWidthFactor: 0.6
          drawStyle: line
          fillOpacity: 7
          gradientMode: none
          hideFrom:
            legend: false
            tooltip: false
            viz: false
          insertNulls: false
          lineInterpolation: linear
          lineWidth: 1
          pointSize: 5
          scaleDistribution:
            type: linear
          showPoints: never
          showValues: false
          spanNulls: false
          stacking:
            group: A
            mode: none
          thresholdsStyle:
            mode: "off"
        decimals: 0
        links: []
        mappings: []
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: short
      overrides:
        - matcher:
            id: byName
            options: Total
          properties:
            - id: custom.drawStyle
              value: line
            - id: custom.fillOpacity
              value: 0
            - id: color
              value:
                fixedColor: "#b877d9"
                mode: fixed
            - id: custom.stacking
              value:
                group: A
                mode: none
    gridPos:
      h: 7
      w: 8
      x: 0
      y: 3
    id: 1
    interval: $agg_interval
    options:
      legend:
        calcs:
          - mean
          - max
          - min
          - sum
        displayMode: list
        placement: bottom
        showLegend: true
        sortBy: Total
        sortDesc: true
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by (service)
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service"}[$__interval] offset -$__interval))> 0
        format: time_series
        interval: ""
        intervalFactor: 1
        legendFormat: "{{service}}"
        range: true
        refId: A
      - datasource:
          type: prometheus
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by ()
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service"}[$__interval] offset -$__interval)) > 0
        interval: ""
        legendFormat: Total
        range: true
        refId: B
    title: Load / $__interval
    type: timeseries
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    fieldConfig:
      defaults:
        color:
          fixedColor: rgb(31, 120, 193)
          mode: palette-classic
        custom:
          axisBorderShow: false
          axisCenteredZero: false
          axisColorMode: text
          axisLabel: ""
          axisPlacement: auto
          barAlignment: 0
          barWidthFactor: 0.6
          drawStyle: line
          fillOpacity: 5
          gradientMode: none
          hideFrom:
            legend: false
            tooltip: false
            viz: false
          insertNulls: false
          lineInterpolation: smooth
          lineWidth: 1
          pointSize: 5
          scaleDistribution:
            type: linear
          showPoints: never
          showValues: false
          spanNulls: false
          stacking:
            group: A
            mode: none
          thresholdsStyle:
            mode: "off"
        decimals: 2
        mappings:
          - options:
              match: "null"
              result:
                text: N/A
            type: special
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: s
      overrides: []
    gridPos:
      h: 7
      w: 8
      x: 8
      y: 3
    interval: $agg_interval
    options:
      legend:
        calcs:
          - mean
          - max
          - min
          - lastNotNull
        displayMode: list
        placement: bottom
        showLegend: true
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          type: prometheus
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by(service)
          (traefik_service_request_duration_seconds_sum{service_namespace=~"$namespace", service=~"$service", protocol=~"http|grpc|grpc-web"})
          /
          sum by(service)(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service", protocol=~"http|grpc|grpc-web"})
        legendFormat: __auto
        range: true
        refId: A
    title: Average response time
    type: timeseries
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    description: Ratio of 4xx and 5xx HTTP responses to all calls.
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          axisBorderShow: false
          axisCenteredZero: false
          axisColorMode: text
          axisLabel: ""
          axisPlacement: auto
          barAlignment: -1
          barWidthFactor: 0.6
          drawStyle: line
          fillOpacity: 14
          gradientMode: none
          hideFrom:
            legend: false
            tooltip: false
            viz: false
          insertNulls: false
          lineInterpolation: smooth
          lineWidth: 1
          pointSize: 5
          scaleDistribution:
            type: linear
          showPoints: never
          showValues: false
          spanNulls: false
          stacking:
            group: A
            mode: none
          thresholdsStyle:
            mode: "off"
        links: []
        mappings: []
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: percent
      overrides: []
    gridPos:
      h: 7
      w: 8
      x: 16
      y: 3
    interval: $agg_interval
    options:
      legend:
        calcs:
          - mean
          - max
          - min
          - lastNotNull
        displayMode: list
        placement: bottom
        showLegend: true
        sortBy: Total
        sortDesc: true
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by (service)
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service", code=~"^[45]\\d{2}"}[$__interval] offset
          -$__interval))/

          sum by (service)
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service"}[$__interval] offset -$__interval)>0)*100
        format: time_series
        interval: ""
        intervalFactor: 1
        legendFormat: "{{ service }}"
        range: true
        refId: A
    title: Errors rate
    type: timeseries
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    description: Load distribution by method, code over $__interval
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          axisBorderShow: false
          axisCenteredZero: false
          axisColorMode: text
          axisLabel: ""
          axisPlacement: auto
          barAlignment: 1
          barWidthFactor: 0.6
          drawStyle: bars
          fillOpacity: 100
          gradientMode: none
          hideFrom:
            legend: false
            tooltip: false
            viz: false
          insertNulls: false
          lineInterpolation: linear
          lineWidth: 1
          pointSize: 5
          scaleDistribution:
            type: linear
          showPoints: never
          showValues: false
          spanNulls: false
          stacking:
            group: A
            mode: normal
          thresholdsStyle:
            mode: "off"
        decimals: 0
        links: []
        mappings: []
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: short
      overrides:
        - matcher:
            id: byName
            options: Total
          properties:
            - id: custom.drawStyle
              value: line
            - id: custom.fillOpacity
              value: 0
            - id: color
              value:
                fixedColor: "#b877d9"
                mode: fixed
            - id: custom.stacking
              value:
                group: A
                mode: none
        - matcher:
            id: byName
            options: HTTP 100-199
          properties:
            - id: color
              value:
                fixedColor: purple
                mode: fixed
        - matcher:
            id: byName
            options: HTTP 200-299
          properties:
            - id: color
              value:
                fixedColor: green
                mode: fixed
        - matcher:
            id: byName
            options: HTTP 300-399
          properties:
            - id: color
              value:
                fixedColor: blue
                mode: fixed
        - matcher:
            id: byName
            options: HTTP 400-499
          properties:
            - id: color
              value:
                fixedColor: orange
                mode: fixed
        - matcher:
            id: byName
            options: HTTP 500-599
          properties:
            - id: color
              value:
                fixedColor: red
                mode: fixed
    gridPos:
      h: 8
      w: 12
      x: 0
      y: 10
    interval: $agg_interval
    options:
      legend:
        calcs:
          - mean
          - max
          - min
          - sum
        displayMode: table
        placement: right
        showLegend: true
        sortBy: Total
        sortDesc: true
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by (code) (
          label_replace(
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service", protocol="http"}[$__interval] offset -$__interval )) >
          0,
            "code", "HTTP ${1}00-${1}99", "code", "^([0-9]).+"
          ))
        format: time_series
        interval: ""
        intervalFactor: 1
        legendFormat: "{{alias}}"
        range: true
        refId: A
      - datasource:
          type: prometheus
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by ()
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service", protocol="http"}[$__interval] offset -$__interval)) > 0
        interval: ""
        legendFormat: Total
        range: true
        refId: B
    title: Load by HTTP codes/$__interval
    type: timeseries
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    description: Load distribution by method, code over $__interval
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          axisBorderShow: false
          axisCenteredZero: false
          axisColorMode: text
          axisLabel: ""
          axisPlacement: auto
          barAlignment: 1
          barWidthFactor: 0.6
          drawStyle: bars
          fillOpacity: 100
          gradientMode: none
          hideFrom:
            legend: false
            tooltip: false
            viz: false
          insertNulls: false
          lineInterpolation: linear
          lineWidth: 1
          pointSize: 5
          scaleDistribution:
            type: linear
          showPoints: never
          showValues: false
          spanNulls: false
          stacking:
            group: A
            mode: normal
          thresholdsStyle:
            mode: "off"
        decimals: 0
        links: []
        mappings: []
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: short
      overrides:
        - matcher:
            id: byName
            options: Total
          properties:
            - id: custom.drawStyle
              value: line
            - id: custom.stacking
              value:
                group: A
                mode: none
            - id: color
              value:
                fixedColor: purple
                mode: fixed
            - id: custom.fillOpacity
              value: 0
    gridPos:
      h: 8
      w: 12
      x: 12
      y: 10
    interval: $agg_interval
    options:
      legend:
        calcs:
          - mean
          - max
          - min
          - sum
        displayMode: table
        placement: right
        showLegend: true
        sortBy: Total
        sortDesc: true
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by (method)
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service", code!=""}[$__interval] offset -$__interval)) >
          0
        format: time_series
        interval: ""
        intervalFactor: 1
        legendFormat: "{{alias}}"
        range: true
        refId: A
      - datasource:
          type: prometheus
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by ()
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service"}[$__interval] offset -$__interval)) > 0
        interval: ""
        legendFormat: Total
        range: true
        refId: B
    title: Load by method/$__interval
    type: timeseries
  - collapsed: false
    gridPos:
      h: 1
      w: 24
      x: 0
      y: 18
    panels: []
    title: Global stats
    type: row
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          axisBorderShow: false
          axisCenteredZero: false
          axisColorMode: text
          axisLabel: ""
          axisPlacement: auto
          barAlignment: 1
          barWidthFactor: 0.6
          drawStyle: bars
          fillOpacity: 100
          gradientMode: none
          hideFrom:
            legend: false
            tooltip: false
            viz: false
          insertNulls: false
          lineInterpolation: linear
          lineWidth: 1
          pointSize: 5
          scaleDistribution:
            type: linear
          showPoints: never
          showValues: false
          spanNulls: false
          stacking:
            group: A
            mode: normal
          thresholdsStyle:
            mode: "off"
        links: []
        mappings: []
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: short
      overrides: []
    gridPos:
      h: 7
      w: 12
      x: 0
      y: 19
    interval: $agg_interval
    options:
      legend:
        calcs:
          - lastNotNull
          - max
          - min
          - mean
          - sum
        displayMode: table
        placement: right
        showLegend: true
        sortBy: Total
        sortDesc: true
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by (method, code)
          (increase(traefik_entrypoint_requests_total{service_namespace=~"$namespace", entrypoint=~"$entrypoint", code=~"^2\\d{2}"}[$__interval] offset
          -$__interval)) > 0
        format: time_series
        intervalFactor: 1
        legendFormat: "{{method}}: {{code}}"
        range: true
        refId: A
    title: Status codes 2xx/$__interval
    type: timeseries
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          axisBorderShow: false
          axisCenteredZero: false
          axisColorMode: text
          axisLabel: ""
          axisPlacement: auto
          barAlignment: 1
          barWidthFactor: 0.6
          drawStyle: bars
          fillOpacity: 100
          gradientMode: none
          hideFrom:
            legend: false
            tooltip: false
            viz: false
          insertNulls: false
          lineInterpolation: linear
          lineWidth: 1
          pointSize: 5
          scaleDistribution:
            type: linear
          showPoints: never
          showValues: false
          spanNulls: false
          stacking:
            group: A
            mode: normal
          thresholdsStyle:
            mode: "off"
        links: []
        mappings: []
        thresholds:
          mode: absolute
          steps:
            - color: green
              value: 0
            - color: red
              value: 80
        unit: short
      overrides: []
    gridPos:
      h: 7
      w: 12
      x: 12
      y: 19
    interval: $agg_interval
    options:
      legend:
        calcs:
          - lastNotNull
          - max
          - min
          - mean
          - sum
        displayMode: table
        placement: right
        showLegend: true
        sortBy: Total
        sortDesc: true
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by (method, code)
          (increase(traefik_entrypoint_requests_total{service_namespace=~"$namespace", entrypoint=~"$entrypoint", code!~"^2\\d{2}"}[$__interval] offset
          -$__interval)) > 0
        format: time_series
        intervalFactor: 1
        legendFormat: "{{ method }} : {{code}}"
        range: true
        refId: A
    title: Others status codes/$__interval
    type: timeseries
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          hideFrom:
            legend: false
            tooltip: false
            viz: false
        mappings: []
        unit: short
      overrides: []
    gridPos:
      h: 7
      w: 12
      x: 0
      y: 26
    interval: $agg_interval
    options:
      legend:
        displayMode: table
        placement: right
        showLegend: true
        values:
          - value
          - percent
      pieType: pie
      reduceOptions:
        calcs:
          - sum
        fields: ""
        values: false
      sort: desc
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by (service)
          (increase(traefik_service_requests_total{service_namespace=~"$namespace", service=~"$service"}[$__interval] offset -$__interval)) > 0
        format: time_series
        interval: ""
        intervalFactor: 2
        legendFormat: "{{ service }}"
        range: true
        refId: A
    title: Requests by service
    type: piechart
  - datasource:
      type: prometheus
      uid:
        secret: openobserve-prometheus-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          hideFrom:
            legend: false
            tooltip: false
            viz: false
        mappings: []
        unit: short
      overrides: []
    gridPos:
      h: 7
      w: 12
      x: 12
      y: 26
    interval: $agg_interval
    options:
      legend:
        displayMode: table
        placement: right
        showLegend: true
        values:
          - value
          - percent
      pieType: pie
      reduceOptions:
        calcs:
          - sum
        fields: ""
        values: false
      sort: desc
      tooltip:
        hideZeros: false
        mode: multi
        sort: desc
    targets:
      - datasource:
          uid:
            secret: openobserve-prometheus-datasource-uid
        editorMode: code
        expr: >-
          sum by (protocol, entrypoint)
          (increase(traefik_entrypoint_requests_total{service_namespace=~"$namespace", entrypoint=~"$entrypoint"}[$__interval] offset -$__interval)) > 0
        format: time_series
        interval: ""
        intervalFactor: 2
        legendFormat: "{{entrypoint}}: {{ protocol }}"
        range: true
        refId: A
    title: Requests by entrypoints and protocol
    type: piechart
  - collapsed: true
    gridPos:
      h: 1
      w: 24
      x: 0
      y: 48
    panels:
      - datasource:
          type: openobserve
          uid:
            secret: openobserve-datasource-uid
        fieldConfig:
          defaults:
            color:
              mode: thresholds
            custom:
              align: auto
              cellOptions:
                type: auto
              filterable: true
              footer:
                reducers: []
              inspect: false
            mappings: []
            thresholds:
              mode: percentage
              steps:
                - color: green
                  value: 0
          overrides: []
        gridPos:
          h: 20
          w: 24
          x: 0
          y: 49
        id: 2
        options:
          cellHeight: sm
          enablePagination: true
          showHeader: true
          sortBy:
            - desc: true
              displayName: Time
        targets:
          - datasource:
              type: openobserve
              uid:
                secret: openobserve-datasource-uid
            displayMode: logs
            organization: default
            query: select * from traefik
            refId: access-logs
            sqlMode: true
            stream: traefik
        title: Access Logs
        type: table
    title: Raw Data
    type: row
  - collapsed: false
    gridPos:
      h: 1
      w: 24
      x: 0
      y: 33
    panels: []
    title: Geography
    type: row
  - datasource:
      type: openobserve
      uid:
        secret: openobserve-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: palette-classic
        custom:
          hideFrom:
            legend: false
            tooltip: false
            viz: false
        mappings: []
        thresholds:
          mode: percentage
          steps:
            - color: green
              value: 0
      overrides: []
    gridPos:
      h: 8
      w: 12
      x: 0
      y: 34
    options:
      basemap:
        config:
          showLabels: false
          theme: auto
        name: Base Map
        noRepeat: true
        type: carto
      controls:
        mouseWheelZoom: true
        showAttribution: true
        showDebug: false
        showMeasure: false
        showScale: false
        showZoom: true
      layers:
        - config:
            blur: 15
            radius: 8
            weight:
              field: request_count
              fixed: 1
              max: 1
              min: 0
          filterData:
            id: byRefId
            options: geolocation
          location:
            latitude: latitude
            longitude: longitude
            mode: coords
          name: coordinates
          opacity: 0.8
          tooltip: true
          type: heatmap
      tooltip:
        mode: details
      view:
        allLayers: true
        id: coords
        lastOnly: false
        lat: 27
        layer: coordinates
        lon: 0
        noRepeat: true
        padding: 5
        shared: false
        zoom: 0
    targets:
      - datasource:
          type: openobserve
          uid:
            secret: openobserve-datasource-uid
        displayMode: auto
        organization: default
        query: >-
          select geoip_location_latitude as latitude, geoip_location_longitude as longitude, count(*) as request_count
          from traefik where geoip_location_latitude is not null and geoip_location_longitude is not null
          group by geoip_location_latitude, geoip_location_longitude
        refId: geolocation
        sqlMode: true
        stream: traefik
    title: Geographic Distribution
    type: geomap
  - datasource:
      type: openobserve
      uid:
        secret: openobserve-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: thresholds
        fieldMinMax: false
        mappings: []
        thresholds:
          mode: percentage
          steps:
            - color: green
              value: 0
      overrides: []
    gridPos:
      h: 8
      w: 12
      x: 12
      y: 34
    options:
      displayMode: basic
      legend:
        calcs: []
        displayMode: list
        placement: bottom
        showLegend: false
      maxVizHeight: 30
      minVizHeight: 30
      minVizWidth: 8
      namePlacement: top
      orientation: horizontal
      reduceOptions:
        calcs:
          - lastNotNull
        fields: ""
        limit: 500
        values: true
      showUnfilled: false
      sizing: manual
      text:
        titleSize: 13
        valueSize: 13
      valueMode: text
    targets:
      - datasource:
          type: openobserve
          uid:
            secret: openobserve-datasource-uid
        displayMode: auto
        organization: default
        query: >-
          select coalesce(geoip_country_name, geoip_registered_country_name) as country_name, count(*) as request_count
          from traefik group by country_name having country_name is not null order by request_count desc
        refId: A
        sqlMode: true
        stream: traefik
    title: Top Countries
    type: bargauge
  - datasource:
      type: openobserve
      uid:
        secret: openobserve-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: thresholds
        custom:
          align: auto
          cellOptions:
            type: auto
          filterable: true
          footer:
            reducers: []
          inspect: false
          wrapText: false
        mappings: []
        thresholds:
          mode: percentage
          steps:
            - color: green
              value: 0
      overrides:
        - matcher:
            id: byName
            options: geoip_autonomous_system_organization
          properties:
            - id: displayName
              value: ASN
        - matcher:
            id: byName
            options: geoip_city_name
          properties:
            - id: displayName
              value: City
        - matcher:
            id: byName
            options: geoip_country_name
          properties:
            - id: displayName
              value: Country
        - matcher:
            id: byName
            options: geoip_registered_country_name
          properties:
            - id: displayName
              value: Registered Country
        - matcher:
            id: byName
            options: request_count
          properties:
            - id: displayName
              value: Request Count
    gridPos:
      h: 6
      w: 16
      x: 0
      y: 42
    options:
      cellHeight: sm
      showHeader: true
      sortBy:
        - desc: true
          displayName: Request Count
    targets:
      - datasource:
          type: openobserve
          uid:
            secret: openobserve-datasource-uid
        displayMode: auto
        organization: default
        query: >-
          select geoip_autonomous_system_organization, geoip_city_name, geoip_country_name, geoip_registered_country_name, count(*) as request_count
          from traefik where downstream_x_geoblock_remediation is not null or downstream_x_crowdsec_remediation = 'ban'
          group by geoip_autonomous_system_organization, geoip_city_name, geoip_country_name, geoip_registered_country_name
        refId: A
        sqlMode: true
        stream: traefik
    title: Top Blocked ASNs
    type: table
  - datasource:
      type: openobserve
      uid:
        secret: openobserve-datasource-uid
    fieldConfig:
      defaults:
        color:
          mode: thresholds
        fieldMinMax: false
        mappings: []
        thresholds:
          mode: percentage
          steps:
            - color: red
              value: 0
      overrides: []
    gridPos:
      h: 6
      w: 8
      x: 16
      y: 42
    options:
      displayMode: basic
      legend:
        calcs: []
        displayMode: list
        placement: bottom
        showLegend: false
      maxVizHeight: 30
      minVizHeight: 30
      minVizWidth: 8
      namePlacement: top
      orientation: horizontal
      reduceOptions:
        calcs:
          - lastNotNull
        fields: ""
        limit: 500
        values: true
      showUnfilled: false
      sizing: manual
      text:
        titleSize: 13
        valueSize: 13
      valueMode: text
    targets:
      - datasource:
          type: openobserve
          uid:
            secret: openobserve-datasource-uid
        displayMode: auto
        organization: default
        query: >-
          select coalesce(geoip_country_name, geoip_registered_country_name) as country_name, count(*) as request_count
          from traefik where downstream_x_geoblock_remediation is not null or downstream_x_crowdsec_remediation = 'ban'
          group by country_name order by request_count desc
        refId: A
        sqlMode: true
        stream: traefik
    title: Top Blocked Countries
    type: bargauge
preload: false
schemaVersion: 42
tags: []
templating:
  list:
    - allowCustomValue: false
      current:
        text: sun
        value: sun
      datasource:
        type: prometheus
        uid:
          secret: openobserve-prometheus-datasource-uid
      definition: label_values(traefik_open_connections, service_namespace)
      includeAll: false
      label: Namespace
      name: namespace
      options: []
      query:
        qryType: 1
        query: label_values(traefik_open_connections, service_namespace)
        refId: PrometheusVariableQueryEditor-VariableQuery
      refresh: 1
      regex: ""
      type: query
    - allValue: .+
      current:
        text: All
        value: $__all
      datasource:
        type: prometheus
        uid:
          secret: openobserve-prometheus-datasource-uid
      definition: label_values(traefik_open_connections{service_namespace="$namespace"}, entrypoint)
      includeAll: true
      label: Entrypoint
      multi: true
      name: entrypoint
      options: []
      query:
        qryType: 1
        query: label_values(traefik_open_connections{service_namespace="$namespace"}, entrypoint)
        refId: PrometheusVariableQueryEditor-VariableQuery
      refresh: 1
      regex: ""
      type: query
    - current:
        text: All
        value: $__all
      datasource:
        type: prometheus
        uid:
          secret: openobserve-prometheus-datasource-uid
      definition: label_values(traefik_service_requests_total{service_namespace="$namespace"}, service)
      includeAll: true
      label: Service
      multi: true
      name: service
      options: []
      query:
        qryType: 1
        query: label_values(traefik_service_requests_total{service_namespace="$namespace"}, service)
        refId: PrometheusVariableQueryEditor-VariableQuery
      refresh: 2
      regex: ""
      type: query
    - auto: true
      auto_count: 100
      auto_min: 1m
      current:
        text: $__auto
        value: $__auto
      description: Desired group interval
      label: Aggregation interval
      name: agg_interval
      options:
        - selected: false
          text: 1m
          value: 1m
        - selected: false
          text: 5m
          value: 5m
        - selected: false
          text: 10m
          value: 10m
        - selected: false
          text: 1h
          value: 1h
        - selected: false
          text: 1d
          value: 1d
      query: 1m,5m,10m,1h,1d
      refresh: 2
      type: interval
timepicker: {}
timezone: browser
title: Traefik
uid:
  secret: traefik-dashboard-uid
