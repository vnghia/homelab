docker:
  images:
    remote:
      docker-cli:
        repo: docker
        tag: "28.5.1-cli"
  volumes:
    local:
      docker-cert:
        backup: false
services:
  docker:
    config:
      dagu:
        docker:
          executor:
            run:
              model: cli
          dags:
            start:
              dag:
                params:
                  main:
                    CONTAINERS: ""
              command:
                - "docker"
                - "start"
                - param: CONTAINERS
            stop:
              dag:
                params:
                  main:
                    CONTAINERS: ""
              command:
                - "docker"
                - "stop"
                - param: CONTAINERS
    files:
      "":
        ca:
          path:
            extract:
              svolume: docker-cert
            transform:
              path: server/ca.pem
          content:
            cert: ca-cert
        cert:
          path:
            extract:
              svolume: docker-cert
            transform:
              path: server/cert.pem
          content:
            cert: server-cert
        key:
          path:
            extract:
              svolume: docker-cert
            transform:
              path: server/key.pem
          content:
            key: server-key
            info: private_pem
    secrets:
      ca-key:
        algorithm: ED25519
      ca-cert:
        key: ca-key
        subject:
          common-name:
            hinfo: address
          organizational-unit: CA
        is-ca-certificate: true
      server-key:
        algorithm: ED25519
      server-cert:
        ca-key: ca-key
        ca-cert: ca-cert
        key: server-key
        allowed-uses: ["server_auth"]
        subject:
          common-name:
            hinfo: address
          organizational-unit: SERVER
    containers:
      cli:
        active: false
        image: docker-cli
        docker-socket:
          write: false
